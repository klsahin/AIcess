{% extends "base.html" %}

{% block title %}Dashboard - FinFriendly{% endblock %}

{% block content %}
<h4 class="mb-3">ðŸ‘‹ Hello! Here are your tasks for {{ today }}:</h4>

{% for reminder in reminders %}
  <div class="card shadow-sm mb-3 border-{% if reminder.urgency == 'high' %}danger{% elif reminder.urgency == 'low' %}success{% else %}secondary{% endif %}">
    <div class="card-body">
      <h5 class="card-title">{{ reminder.title }}</h5>
      <p class="card-text">
        <strong>Time:</strong> {{ reminder.time }} |
        <strong>Urgency:</strong> {{ reminder.urgency|capitalize }}
      </p>
      <button class="btn btn-outline-primary btn-sm">Mark as Done</button>
    </div>
  </div>
{% endfor %}

<h5 class="mt-4">ðŸ’¬ Ask FinBot for help</h5>
<div class="input-group mb-3">
  <input type="text" id="userInput" class="form-control" placeholder="e.g., Where can I cut spending?">
  <button class="btn btn-success" onclick="sendMessage()">Ask</button>
</div>
<div class="alert alert-info d-none chatbot-response" id="responseBox"></div>

<script>
  async function sendMessage() {
    const input = document.getElementById('userInput');
    const resBox = document.getElementById('responseBox');
    const response = await fetch('/chatbot', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: input.value })
    });
    const data = await response.json();
    resBox.textContent = data.reply;
    resBox.classList.remove('d-none');
    input.value = '';
  }
</script>
{% endblock %}
